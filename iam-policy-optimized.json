{"Version":"2012-10-17","Statement":[{"Sid":"Lambda","Effect":"Allow","Action":"lambda:*","Resource":["arn:aws:lambda:*:*:function:ielts-*","arn:aws:lambda:*:*:function:*-ielts-*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"DynamoDB","Effect":"Allow","Action":"dynamodb:*","Resource":["arn:aws:dynamodb:*:*:table/ielts-*","arn:aws:dynamodb:*:*:table/ielts-*/index/*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"APIGateway","Effect":"Allow","Action":"apigateway:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"S3","Effect":"Allow","Action":"s3:*","Resource":["arn:aws:s3:::ielts-*","arn:aws:s3:::ielts-*/*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"SES","Effect":"Allow","Action":"ses:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"CloudFront","Effect":"Allow","Action":"cloudfront:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Route53","Effect":"Allow","Action":["route53:*","route53domains:*"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"ACM","Effect":"Allow","Action":"acm:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Logs","Effect":"Allow","Action":["logs:*","cloudwatch:*"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"KMS","Effect":"Allow","Action":["kms:Create*","kms:Describe*","kms:Enable*","kms:List*","kms:Put*","kms:Update*","kms:Revoke*","kms:Disable*","kms:Get*","kms:Delete*","kms:ScheduleKeyDeletion","kms:CancelKeyDeletion","kms:Encrypt","kms:Decrypt","kms:ReEncrypt*","kms:GenerateDataKey*"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"BedrockNova","Effect":"Allow","Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Resource":"arn:aws:bedrock:*::foundation-model/amazon.nova-micro-v1:0","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"BedrockRead","Effect":"Allow","Action":["bedrock:GetFoundationModel","bedrock:ListFoundationModels","bedrock:GetModelInvocationLoggingConfiguration","bedrock:PutModelInvocationLoggingConfiguration"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"CFN","Effect":"Allow","Action":"cloudformation:*","Resource":["arn:aws:cloudformation:*:*:stack/ielts-*/*","arn:aws:cloudformation:*:*:stack/*-ielts-*/*","arn:aws:cloudformation:*:*:stackset/ielts-*:*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Cache","Effect":"Allow","Action":"elasticache:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Scaling","Effect":"Allow","Action":["application-autoscaling:*","autoscaling:*"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Cognito","Effect":"Allow","Action":"cognito-idp:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"SNS","Effect":"Allow","Action":"sns:*","Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Transcribe","Effect":"Allow","Action":["transcribe:StartTranscriptionJob","transcribe:GetTranscriptionJob","transcribe:ListTranscriptionJobs","transcribe:DeleteTranscriptionJob"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"EC2Read","Effect":"Allow","Action":["ec2:DescribeVpcs","ec2:DescribeRegions","ec2:DescribeNetworkInterfaces","ec2:DescribeSubnets","ec2:DescribeSecurityGroups"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"IAMRead","Effect":"Allow","Action":["iam:GetRole","iam:GetRolePolicy","iam:ListRoles","iam:ListRolePolicies","iam:ListAttachedRolePolicies","iam:GetUser","iam:GetPolicy","iam:GetPolicyVersion","iam:ListPolicies","iam:ListPolicyVersions","iam:ChangePassword"],"Resource":"*","Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"IAMPass","Effect":"Allow","Action":"iam:PassRole","Resource":["arn:aws:iam::*:role/ielts-*","arn:aws:iam::*:role/*-ielts-*","arn:aws:iam::*:role/service-role/ielts-*"],"Condition":{"StringEquals":{"aws:username":"WWP","iam:PassedToService":["lambda.amazonaws.com","apigateway.amazonaws.com","cloudformation.amazonaws.com","dynamodb.amazonaws.com","elasticache.amazonaws.com","autoscaling.amazonaws.com","application-autoscaling.amazonaws.com","s3.amazonaws.com","cloudfront.amazonaws.com","cognito-idp.amazonaws.com","transcribe.amazonaws.com"]}}},{"Sid":"IAMRole","Effect":"Allow","Action":["iam:CreateRole","iam:AttachRolePolicy","iam:DetachRolePolicy","iam:PutRolePolicy","iam:DeleteRolePolicy","iam:CreatePolicy"],"Resource":["arn:aws:iam::*:role/ielts-*","arn:aws:iam::*:role/*-ielts-*","arn:aws:iam::*:policy/ielts-*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"IAMSLR","Effect":"Allow","Action":"iam:CreateServiceLinkedRole","Resource":["arn:aws:iam::*:role/aws-service-role/elasticache.amazonaws.com/*","arn:aws:iam::*:role/aws-service-role/autoscaling.amazonaws.com/*","arn:aws:iam::*:role/aws-service-role/dynamodb.application-autoscaling.amazonaws.com/*","arn:aws:iam::*:role/aws-service-role/lambda.amazonaws.com/*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"Secrets","Effect":"Allow","Action":["secretsmanager:GetSecretValue","secretsmanager:CreateSecret","secretsmanager:UpdateSecret","secretsmanager:DescribeSecret","secretsmanager:PutSecretValue","secretsmanager:ListSecrets","secretsmanager:TagResource"],"Resource":["arn:aws:secretsmanager:*:*:secret:gemini-vertex-ai-credentials-*","arn:aws:secretsmanager:*:*:secret:ielts-*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"SSM","Effect":"Allow","Action":["ssm:GetParameter","ssm:GetParameters","ssm:GetParametersByPath","ssm:PutParameter","ssm:DeleteParameter","ssm:DescribeParameters","ssm:AddTagsToResource"],"Resource":["arn:aws:ssm:*:*:parameter/ielts/*","arn:aws:ssm:*:*:parameter/gemini/*"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"SAM","Effect":"Allow","Action":["cloudformation:CreateChangeSet","cloudformation:ExecuteChangeSet","cloudformation:DescribeChangeSet","cloudformation:DescribeStackEvents","cloudformation:DescribeStacks","cloudformation:GetTemplate","cloudformation:ListStackResources","cloudformation:ValidateTemplate"],"Resource":["arn:aws:cloudformation:*:*:stack/aws-sam-cli-managed-default/*","arn:aws:cloudformation:*:aws:transform/Serverless-2016-10-31"],"Condition":{"StringEquals":{"aws:username":"WWP"}}},{"Sid":"DenyProdDelete","Effect":"Deny","Action":["dynamodb:DeleteTable","s3:DeleteBucket","lambda:DeleteFunction","cloudformation:DeleteStack"],"Resource":["arn:aws:dynamodb:*:*:table/ielts-genai-prep-*-production","arn:aws:dynamodb:*:*:table/*-production","arn:aws:s3:::ielts-*-production","arn:aws:s3:::*-production","arn:aws:lambda:*:*:function:production-ielts-*","arn:aws:lambda:*:*:function:*-production","arn:aws:cloudformation:*:*:stack/ielts-*-production/*","arn:aws:cloudformation:*:*:stack/*-production/*"]}]}
